<div *ngIf="tattooWork |async as tattooWork">
  <mat-sidenav-container style="height: 1200px">
    <mat-sidenav style="width: 600px" #sidenav mode="side">
      <br>
      <img routerLink="/users/{{tattooWork.madeBy.id}}"
           style="margin-left: 33%;
         height: 200px;
          cursor: pointer;
          width: 200px;
          border-radius: 50%;" src="{{tattooWork.madeBy.avatarUrl}}">
      <p style="text-align: center">{{tattooWork.madeBy.firstName}} {{tattooWork.madeBy.lastName}}</p>
      <br>
      <h2 style="text-align: center">Contact</h2>
      <p style="text-align: center">{{tattooWork.madeBy.phoneNumber}}</p>
      <p style="text-align: center">{{tattooWork.madeBy.email}}</p>
      <br>
      <h2 style="text-align: center">Average Rating</h2>
      <p style="text-align: center">{{tattooWork.madeBy.street}}</p>
      <br>
      <h2 style="text-align: center">Address</h2>
      <p style="text-align: center">{{tattooWork.madeBy.city}}</p>
      <p style="text-align: center">{{tattooWork.madeBy.country}}</p>
      <p style="text-align: center">{{tattooWork.madeBy.postalCode}}</p>
      <p style="text-align: center">{{tattooWork.madeBy.otherInformation}}</p>
      <p style="text-align: center">{{tattooWork.madeBy.state}}</p>
      <p style="text-align: center">{{tattooWork.madeBy.street}}</p>

      <button *ngIf="tattooWork.madeBy.id !== authenticatedUser?.id" (click)="handleSendMessage(tattooWork.madeBy.id)" mat-flat-button color="accent" style="width: 100%">Send
        direct message to owner
      </button>

    </mat-sidenav>

    <mat-sidenav-content>
      <button *ngIf="!sidenav.opened" mat-button (click)="sidenav.toggle()">
        <mat-icon>arrow_forward_ios_new</mat-icon>
      </button>
      <button *ngIf="sidenav.opened" mat-button (click)="sidenav.toggle()">
        <mat-icon>arrow_back_ios_new</mat-icon>
      </button>

      <button *ngIf="tattooWork.madeBy.id===authenticatedUser?.id" style="margin-left: auto" routerLink="/edit-tattoo-work/{{tattooWork.id}}" mat-flat-button color="primary">edit tattoo work</button>
      <button *ngIf="tattooWork.madeBy.id===authenticatedUser?.id" style="margin-left: auto" (click)="deleteTattooWork(tattooWork.id)" mat-flat-button color="warn">delete tattoo work</button>

      <div style="margin-left: 5%; ">
        <swiper
          style="--swiper-navigation-color: #fff;--swiper-pagination-color: #fff"
          [autoplay]="true"
          [navigation]="true"
          [spaceBetween]="10"
          [thumbs]="{ swiper: thumbsSwiper }"
          class="mySwiper2">
          <ng-template swiperSlide *ngFor="let image of images">
            <img src="{{image}}" />
          </ng-template>
        </swiper>
        <swiper
          [freeMode]="true"
          [slidesPerView]="4"
          [spaceBetween]="10"
          (swiper)="thumbsSwiper = $event"
          [watchSlidesProgress]="true"
          class="mySwiper">
          <ng-template swiperSlide *ngFor="let image of images">
            <img class="img1" src="{{image}}" />
          </ng-template>
        </swiper>

        <h1>Description: {{tattooWork.description}}</h1>
        <h1>Price: {{tattooWork.price}} {{tattooWork.currency}}</h1>
        <h1>Like: {{tattooWork.like_number}}</h1>
        <h1>Dislike: {{tattooWork.dislike_number}}</h1>

        <hr>
        <h1>Comment</h1>


        <div *ngIf=" (tattooWork.clientId === authenticatedUser?.id) && (comment===null)">
          <form *ngIf="commentFormGroup" [formGroup]="commentFormGroup" (ngSubmit)="submit()">
            <div formGroupName="commentGroup">
              <mat-form-field appearance="fill" color="accent">
                <mat-label>Update Comment</mat-label>
                <input matInput formControlName="message" required>
                <mat-error>Comment is required !</mat-error>
              </mat-form-field>
              <mat-form-field style="margin-left: 10px" appearance="fill">
                <mat-label>Rate</mat-label>
                <mat-select formControlName="rate">
                  <mat-option *ngFor="let rate of rates" [value]="rate">{{rate}}</mat-option>
                </mat-select>
                <mat-error>Rate is required !</mat-error>
              </mat-form-field>
              <button [disabled]="!commentFormGroup.valid" mat-button mat-flat-button color="accent" (submit)="submit()">Send</button>
            </div>
          </form>
        </div>

        <div style="max-width: 1000px" *ngIf="(comment!==null)&& (comment!==undefined)">
          <mat-card>
            <mat-card-title-group>
              <mat-card-title>{{comment.postedBy.firstName}}{{comment.postedBy.lastName}}</mat-card-title>
              <mat-card-subtitle>{{comment.postDate}}</mat-card-subtitle>
              <mat-card-subtitle>{{comment.rate}}</mat-card-subtitle>
              <img mat-card-sm-image src="{{comment.postedBy.avatarUrl}}">
            </mat-card-title-group>
            <mat-card-content>
              {{comment.message}}

              <br>
              <div *ngIf="isClicked===true">
                <hr>
                <form *ngIf="commentUpdateFormGroup" [formGroup]="commentUpdateFormGroup">
                  <div formGroupName="commentUpdateGroup">
                    <mat-form-field appearance="fill" color="accent">
                      <mat-label>Update Comment</mat-label>
                      <input matInput formControlName="message" required>
                      <mat-error>Comment is required !</mat-error>
                    </mat-form-field>
                    <mat-form-field style="margin-left: 10px" appearance="fill">
                      <mat-label>Rate</mat-label>
                      <mat-select formControlName="rate">
                        <mat-option *ngFor="let rate of rates" [value]="rate">{{rate}}</mat-option>
                      </mat-select>
                      <mat-error>Rate is required !</mat-error>
                    </mat-form-field>
                    <button [disabled]="!commentUpdateFormGroup.valid" *ngIf="comment.postedBy.id==authenticatedUser?.id" mat-flat-button
                            color="accent" (click)="editComment(comment.id)">update
                    </button>
                  </div>
                </form>
                <hr>
              </div>
            </mat-card-content>
            <mat-card-actions>

              <button *ngIf="comment.postedBy.id===authenticatedUser?.id" mat-flat-button color="warn"
                      (click)="deleteComment(comment.id)">delete
              </button>
              <button *ngIf="comment.postedBy.id===authenticatedUser?.id && isClicked=== false"
                      mat-flat-button color="accent" (click)="openCommentEditSection(comment.id)">edit
              </button>
              <hr>
            </mat-card-actions>
          </mat-card>

        </div>

      </div>
    </mat-sidenav-content>
  </mat-sidenav-container>

</div>
